SELECT
SUM(CASE WHEN transaction_date BETWEEN DATE('2022-07-04') - INTERVAL '12 MONTHS' AND DATE('2022-07-04') THEN 1 ELSE 0 END) AS PAST_12,
SUM(CASE WHEN transaction_date BETWEEN DATE('2022-07-04') - INTERVAL '6 MONTHS' AND DATE('2022-07-04') THEN 1 ELSE 0 END) AS PAST_6,
SUM(CASE WHEN transaction_date BETWEEN DATE('2022-07-04') - INTERVAL '3 MONTHS' AND DATE('2022-07-04') THEN 1 ELSE 0 END) AS PAST_3,
SUM(CASE WHEN transaction_date BETWEEN DATE('2022-07-04') + INTERVAL '1 DAYS' AND DATE('2022-07-04') + INTERVAL '3 MONTHS' THEN 1 ELSE 0 END) AS NEXT_3,
SUM(CASE WHEN transaction_date BETWEEN DATE('2022-07-04') + INTERVAL '1 DAYS' AND DATE('2022-07-04') + INTERVAL '6 MONTHS' THEN 1 ELSE 0 END) AS NEXT_6,
SUM(CASE WHEN transaction_date BETWEEN DATE('2022-07-04') + INTERVAL '1 DAYS' AND DATE('2022-07-04') + INTERVAL '12 MONTHS' THEN 1 ELSE 0 END) AS NEXT_12
FROM transactions;
